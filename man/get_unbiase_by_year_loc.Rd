% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_unbiase.R
\name{get_unbiase_by_year_loc}
\alias{get_unbiase_by_year_loc}
\title{Calculate BLUP or BLUE Values for Multi-Environment Trials}
\usage{
get_unbiase_by_year_loc(
  x,
  Tag = "FBL",
  method = "blup",
  year.name = "year",
  loc.name = "location",
  trait.name = "trait",
  line.name = "line",
  value.name = "value",
  use_interaction = TRUE
)
}
\arguments{
\item{x}{Input data frame.}

\item{Tag}{Trait name to analyze.}

\item{method}{Method to use: "blup" (Random effects) or "blue" (Fixed effects).}

\item{year.name}{Column name for year.}

\item{loc.name}{Column name for location.}

\item{trait.name}{Column name for trait.}

\item{line.name}{Column name for line/genotype.}

\item{value.name}{Column name for phenotypic value.}

\item{use_interaction}{Logical. Include GxE interaction terms in the model?}
}
\value{
An object of class \code{\linkS4class{BreedingValue}}.
}
\description{
Calculates BLUP or BLUE values and returns an S4 object containing results,
metadata, and estimated broad-sense heritability.
}
\examples{
# 1. Create synthetic data for demonstration
set.seed(123)
n_lines <- 20
n_loc <- 3
n_year <- 2
rep_per_loc <- 2

df_test <- expand.grid(
  line = paste0("L", 1:n_lines),
  location = paste0("Loc", 1:n_loc),
  year = paste0("202", 1:n_year),
  rep = 1:rep_per_loc
)

# Simulate Phenotypic Value: G + E + GxE + error
# Genetic effect (true value)
g_eff <- setNames(rnorm(n_lines, mean = 0, sd = 5), paste0("L", 1:n_lines))

# Construct value
df_test$value <- 100 +
  g_eff[df_test$line] +                 # G
  rnorm(nrow(df_test), 0, 10) +         # E + GxE combined noise
  rnorm(nrow(df_test), 0, 2)            # Residual

df_test$trait_name <- "Yield"

# 2. Run BLUP Analysis
# This will calculate BLUPs and estimate Heritability
res_blup <- get_unbiase_by_year_loc(
  x = df_test,
  Tag = "Yield",
  method = "blup",
  trait.name = "trait_name"
)

# Show the object (Auto-print summary)
res_blup

# 3. Run BLUE Analysis
res_blue <- get_unbiase_by_year_loc(
  x = df_test,
  Tag = "Yield",
  method = "blue",
  trait.name = "trait_name"
)

res_blue

# 4. Get the complete table (Results + Raw Data)
full_table <- get_complete_table(res_blup)
head(full_table)

}
