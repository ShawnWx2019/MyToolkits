% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_emmax_manhattan.R
\name{plot_emmax_manhattan}
\alias{plot_emmax_manhattan}
\title{Plot Multi-Trait or Single-Trait Manhattan Plot from GWAS Results}
\usage{
plot_emmax_manhattan(
  gwas_input,
  trait_name = NULL,
  threshold = 4,
  sample_rate = 0.5,
  point_size_min = 0.3,
  point_size_max = 1,
  trait_colors = NULL,
  chr_colors = c("grey80", "lightblue")
)
}
\arguments{
\item{gwas_input}{A named list of dataframes (for multi-trait) or a single dataframe (for single-trait).
Each dataframe MUST contain at least three columns named exactly:
"CHR" (Chromosome), "BP" (Position), and "P" (P-value).}

\item{trait_name}{Character or Vector. Optional. The name(s) of the trait(s) to appear in the legend.
\itemize{
\item If input is a single dataframe: Provide a single string (e.g., "Yield").
\item If input is a list: Provide a vector of strings matching the list length. If NULL, list names are used.
}}

\item{threshold}{Numeric. The -log10(P) threshold line. SNPs above this line are considered significant. Default is 4.}

\item{sample_rate}{Numeric (0-1). The proportion of insignificant SNPs to retain for plotting to reduce file size and rendering time. Default is 0.5 (50 percent).}

\item{point_size_min}{Numeric. Point size for insignificant SNPs. Default is 0.3.}

\item{point_size_max}{Numeric. Point size for significant SNPs. Default is 1.0.}

\item{trait_colors}{Vector. Custom colors for significant SNPs (one color per trait). If NULL, uses a default high-contrast palette.}

\item{chr_colors}{Vector of length 2. Colors for alternating chromosomes (background points). Default is c("grey80", "lightblue").}
}
\value{
A ggplot object.
}
\description{
This function generates a Manhattan plot using ggplot2. It supports merging multiple
GWAS results into a single plot. It is designed to be flexible with input formats,
provided the correct column names are used.
}
\examples{
\dontrun{
library(dplyr)

# ------------------------------------------------------------------
# Scenario 1: Plotting EMMAX results (Usually no header)
# ------------------------------------------------------------------
# EMMAX output typically lacks headers. You must manually assign specific names:
# "CHR", "BP", "P".

df_emmax <- read.table("path/to/emmax_result.txt", header = FALSE) \%>\%
  setNames(c("CHR", "BP", "P"))

# Basic plot
plot_emmax_manhattan(df_emmax, threshold = 6)

# Plot with custom trait name in legend
plot_emmax_manhattan(df_emmax, trait_name = "Cotton_Fiber", threshold = 6)

# ------------------------------------------------------------------
# Scenario 2: Plotting results from other tools (e.g., GAPIT, TASSEL)
# ------------------------------------------------------------------
# Other tools usually have headers like "Chromosome", "Pos", "P.value".
# You MUST rename them to "CHR", "BP", "P" before plotting.

df_other <- read.csv("path/to/other_gwas_result.csv", header = TRUE) \%>\%
  dplyr::rename(CHR = Chromosome, BP = Pos, P = P.value)

plot_emmax_manhattan(df_other, threshold = 6)

# ------------------------------------------------------------------
# Scenario 3: Merging Multiple Traits
# ------------------------------------------------------------------

my_list <- list("Petal-Rutin" = df_emmax, "Leaf-Morin" = df_other)

# You can also use trait_name argument to rename them on the fly:
# trait_name = c("Rutin", "Morin")

plot_emmax_manhattan(my_list,
                     threshold = 5.13,
                     trait_colors = c("firebrick", "dodgerblue"))
}
}
